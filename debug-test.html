<!DOCTYPE html>
<html>
<head>
    <title>–û—Ç–ª–∞–¥–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f0f0f0; }
        .log { margin: 5px 0; padding: 5px; border-left: 3px solid #007bff; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        .success { border-left-color: #28a745; background: #d4edda; }
        .warning { border-left-color: #ffc107; background: #fff3cd; }
    </style>
</head>
<body>
    <h1>üîç –û—Ç–ª–∞–¥–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h1>
    <div id="logs"></div>

    <script>
        const logs = document.getElementById('logs');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logs.appendChild(div);
            console.log(message);
        }

        log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç–ª–∞–¥–∫—É...');

        try {
            log('üìã –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª data.js...');
            
            // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º script —Ç–µ–≥–∏
            function loadScript(src) {
                return new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = src;
                    script.onload = resolve;
                    script.onerror = () => reject(new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å ${src}`));
                    document.head.appendChild(script);
                });
            }

            async function loadScripts() {
                try {
                    log('üìÇ –ó–∞–≥—Ä—É–∂–∞–µ–º data.js...');
                    await loadScript('js/data.js');
                    log('‚úÖ data.js –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    
                    log('üìÇ –ó–∞–≥—Ä—É–∂–∞–µ–º storage.js...');
                    await loadScript('js/storage.js');
                    log('‚úÖ storage.js –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    
                    log('üìÇ –ó–∞–≥—Ä—É–∂–∞–µ–º games.js...');
                    await loadScript('js/games.js');
                    log('‚úÖ games.js –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç—ã
                    log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º DISCIPLINES_DATA...');
                    if (typeof DISCIPLINES_DATA !== 'undefined') {
                        const count = Object.keys(DISCIPLINES_DATA).length;
                        log(`‚úÖ DISCIPLINES_DATA –Ω–∞–π–¥–µ–Ω (${count} –¥–∏—Å—Ü–∏–ø–ª–∏–Ω)`, 'success');
                    } else {
                        log('‚ùå DISCIPLINES_DATA –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                    }
                    
                    log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º StorageManager...');
                    if (typeof StorageManager !== 'undefined') {
                        log('‚úÖ StorageManager –Ω–∞–π–¥–µ–Ω', 'success');
                        
                        // –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
                        try {
                            log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º StorageManager...');
                            StorageManager.init();
                            log('‚úÖ StorageManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'success');
                            
                            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                            log('üìä –¢–µ—Å—Ç–∏—Ä—É–µ–º StorageManager.get()...');
                            const progress = StorageManager.get(StorageManager.KEYS.PROGRESS);
                            log(`‚úÖ –ü–æ–ª—É—á–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å: ${progress ? Object.keys(progress).length : 0} –¥–∏—Å—Ü–∏–ø–ª–∏–Ω`, 'success');
                            
                        } catch (e) {
                            log(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ StorageManager: ${e.message}`, 'error');
                        }
                        
                    } else {
                        log('‚ùå StorageManager –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                    }
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º calculateTotalProgress
                    log('üßÆ –¢–µ—Å—Ç–∏—Ä—É–µ–º calculateTotalProgress...');
                    try {
                        // –°–æ–∑–¥–∞–µ–º –º–æ–∫-–æ–±—ä–µ–∫—Ç App –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                        const testApp = {
                            calculateTotalProgress: function() {
                                const progress = StorageManager.get(StorageManager.KEYS.PROGRESS);
                                let totalCards = 0;
                                let knownCards = 0;
                                
                                Object.keys(DISCIPLINES_DATA).forEach(key => {
                                    totalCards += DISCIPLINES_DATA[key].flashcards.length;
                                    knownCards += progress[key].knownCards.length;
                                });
                                
                                return Math.round((knownCards / totalCards) * 100);
                            }
                        };
                        
                        const totalProgress = testApp.calculateTotalProgress();
                        log(`‚úÖ calculateTotalProgress() –≤–µ—Ä–Ω—É–ª: ${totalProgress}%`, 'success');
                        
                    } catch (e) {
                        log(`‚ùå –û—à–∏–±–∫–∞ –≤ calculateTotalProgress(): ${e.message}`, 'error');
                        log(`Stack: ${e.stack}`, 'error');
                    }
                    
                    log('üéØ –ì–æ—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!', 'success');
                    
                } catch (error) {
                    log(`‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`, 'error');
                    log(`Stack: ${error.stack}`, 'error');
                }
            }
            
            loadScripts();
            
        } catch (e) {
            log(`‚ùå –û–±—â–∞—è –æ—à–∏–±–∫–∞: ${e.message}`, 'error');
        }
        
        setTimeout(() => {
            log('‚è∞ –û—Ç–ª–∞–¥–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥');
        }, 10000);
        
    </script>
</body>
</html>